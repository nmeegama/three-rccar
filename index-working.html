<!DOCTYPE html>
<html lang="en">
<head>
  <title>three.js webgl - loaders - Clara.io JSON loader</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
  <style>
    body {
      font-family: Monospace;
      color: #fff;
      margin: 0px;
      overflow: hidden;
    }
    #info a, .button { color: #f00; font-weight: bold; text-decoration: underline; cursor: pointer }
  </style>
</head>

<body>
<div id="car" style="width: 500px; height: 500px"></div>
<script src="node_modules/three/build/three.js"></script>
<script src="node_modules/jquery/dist/jquery.js"></script>



<script>
$(document).ready(function () {
  var container = $('#car');
  var camera, scene, renderer;
  var mouseX = 0, mouseY = 0;
  var windowHalfX = window.innerWidth / 2;
  var windowHalfY = window.innerHeight / 2;


  init();
  animate();


  function init() {



    console.log(container.width())

    camera = new THREE.PerspectiveCamera( 70, container.width()/ container.height(), 0.1, 200);
    camera.position.y = 150;
    camera.position.z = 50;


    scene = new THREE.Scene();

    var ambient = new THREE.AmbientLight( 0x050505 );
    scene.add( ambient );

    directionalLight = new THREE.DirectionalLight( 0xffffff, 2 );
    directionalLight.position.set( 2, 1.2, 10 ).normalize();
    scene.add( directionalLight );

    directionalLight = new THREE.DirectionalLight( 0xffffff, 1 );
    directionalLight.position.set( - 2, 1.2, -10 ).normalize();
    scene.add( directionalLight );

    pointLight = new THREE.PointLight( 0xffaa00, 2 );
    pointLight.position.set( 2000, 1200, 10000 );
    scene.add( pointLight );

    var objectLoader = new THREE.ObjectLoader();
    objectLoader.load("car_a.json", function ( obj ) {
      console.log(obj.children);
      for (i in obj.children) {
        console.log(obj.children[i])
        if(obj.children[i].material.color !== undefined) {
          obj.children[i].material.color.setHex(0xff0000);
        }

      }
      scene.add( obj );
    } );
    console.log(scene);
    renderer = new THREE.WebGLRenderer();
    renderer.setPixelRatio( window.devicePixelRatio );
    renderer.setSize(container.width(), container.height() );
    container.append( $(renderer.domElement) );

    document.addEventListener( 'mousemove', onDocumentMouseMove, false );
    window.addEventListener( 'resize', onWindowResize, false );
  }
  function onWindowResize() {
    windowHalfX = window.innerWidth / 2;
    windowHalfY = window.innerHeight / 2;
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize( window.innerWidth, window.innerHeight );

  }
  function onDocumentMouseMove( event ) {
    mouseX = ( event.clientX - windowHalfX ) / 2;
    mouseY = ( event.clientY - windowHalfY ) / 2;

  }
  function animate() {
    requestAnimationFrame( animate );
    render();

  }

  function render() {

    camera.position.x += ( mouseX - camera.position.x ) * .05;
    camera.position.y += ( - mouseY - camera.position.y ) * .05;
    camera.lookAt( scene.position );
    renderer.render( scene, camera );

  }
})


</script>

</body>
</html>